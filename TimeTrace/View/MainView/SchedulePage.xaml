<Page
	x:Class="TimeTrace.View.MainView.SchedulePage"
	xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:converters="using:TimeTrace.View.Converters"
	xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
	xmlns:local="using:TimeTrace.Model.Events"
	xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
	mc:Ignorable="d">

	<Page.Resources>
		<ResourceDictionary>
			<converters:FromNullableIntToIntConverter x:Key="fromNullableIntToIntConverter" />
			<Style TargetType="StackPanel">
				<Setter Property="Transitions">
					<Setter.Value>
						<TransitionCollection>
							<EntranceThemeTransition />
						</TransitionCollection>
					</Setter.Value>
				</Setter>
			</Style>
			<ResourceDictionary.MergedDictionaries>
				<ResourceDictionary Source="/ResourceDictionaries/MainDictionary.xaml" />
			</ResourceDictionary.MergedDictionaries>
		</ResourceDictionary>
	</Page.Resources>

	<Grid Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

		<Grid.ColumnDefinitions>
			<ColumnDefinition />
			<ColumnDefinition Width="Auto" />
		</Grid.ColumnDefinitions>

		<ScrollViewer VerticalScrollBarVisibility="Auto">
			<StackPanel Margin="10">
				<ListView ItemsSource="{x:Bind ViewModel.MapEvents, Mode=TwoWay}" SelectedIndex="{x:Bind ViewModel.SelectedMapEvent, Mode=TwoWay, Converter={StaticResource fromNullableIntToIntConverter}}">
					<ListView.ItemTemplate>
						<DataTemplate x:DataType="local:MapEvent">
							<StackPanel>
								<TextBlock
									Margin="10,5,10,0"
									FontSize="26"
									Text="{x:Bind Name}"
									TextWrapping="WrapWholeWords" />

								<StackPanel Orientation="Horizontal">
									<TextBlock
										Margin="10,3,0,2"
										FontSize="18"
										Text="Время: " />
									<TextBlock
										Margin="7,3,7,2"
										FontSize="18"
										Text="{x:Bind Start}" />
									<TextBlock
										Margin="0,3,0,2"
										FontSize="18"
										Text="-" />
									<TextBlock
										Margin="7,3,7,2"
										FontSize="18"
										Text="{x:Bind End}" />
								</StackPanel>

								<StackPanel Orientation="Horizontal">
									<TextBlock
										Margin="10,0,0,0"
										FontSize="18"
										Text="Место: " />
									<TextBlock
										Margin="7,0,0,0"
										FontSize="18"
										Text="{x:Bind Location, TargetNullValue=Неизвестно}" />
									<TextBlock
										Margin="0,0,0,0"
										FontSize="18"
										Text=";" />
									<TextBlock
										Margin="10,0,0,0"
										FontSize="18"
										Text="Контакт: " />
									<TextBlock
										Margin="7,0,0,0"
										FontSize="18"
										Text="{x:Bind UserBind, TargetNullValue=Неизвестен}" />
								</StackPanel>

								<StackPanel Orientation="Horizontal">
									<TextBlock
										Margin="10,5,0,5"
										FontSize="18"
										Text="Описание: " />
									<TextBlock
										Margin="7,5"
										FontSize="18"
										Text="{x:Bind Description, TargetNullValue=Отсутствует}" />
								</StackPanel>
							</StackPanel>
						</DataTemplate>
					</ListView.ItemTemplate>
					<ListView.ContextFlyout>
						<MenuFlyout Placement="Bottom">
							<MenuFlyoutItem
								Click="{x:Bind ViewModel.MoreAboutMapEvent}"
								Icon="Page"
								Text="Подробней" />
							<MenuFlyoutSeparator />
							<MenuFlyoutItem Icon="Edit" Text="Редактировать" />
							<MenuFlyoutItem
								Click="{x:Bind ViewModel.MapEventRemove}"
								Icon="Delete"
								Text="Удалить" />
						</MenuFlyout>
					</ListView.ContextFlyout>
				</ListView>
			</StackPanel>
		</ScrollViewer>

		<Grid Grid.Column="1">
			<Grid.RowDefinitions>
				<RowDefinition />
				<RowDefinition Height="Auto" />
			</Grid.RowDefinitions>

			<StackPanel Margin="15,20,35,20">
				<TextBlock
					Margin="0,0,0,20"
					FontSize="28"
					Text="Укажите дату"
					TextWrapping="WrapWholeWords" />
				<CalendarView
					HorizontalAlignment="Center"
					SelectedDatesChanged="{x:Bind ViewModel.DateSelection}"
					SelectionMode="Single" />
				<Button
					Margin="14"
					HorizontalAlignment="Stretch"
					Background="SteelBlue"
					Content="Сбросить даты"
					Foreground="White" />
			</StackPanel>

			<Button
				Grid.Row="1"
				Margin="50,0,50,40"
				HorizontalAlignment="Center"
				VerticalAlignment="Bottom"
				Background="SteelBlue"
				Content="Создать событие"
				Foreground="White">
				<Button.Flyout>
					<Flyout>
						<Flyout.Content>
							<TextBlock Text="Вы уверены?" />
						</Flyout.Content>
					</Flyout>
				</Button.Flyout>
			</Button>

		</Grid>

	</Grid>
</Page>